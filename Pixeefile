import pandas as pd
import requests

# Configuration
API_URL = "https://demo.defectdojo.org/api/v2/users/"
API_TOKEN = "djsjdjdjd"  # Replace with your actual token if different
EXCEL_FILE = "users.xlsx"  # Path to your Excel file

# Headers for API request
headers = {
    "Authorization": f"Token {API_TOKEN}",
    "Content-Type": "application/json"
}

# Read the Excel file
df = pd.read_excel(EXCEL_FILE)

# Iterate over each row and create users
for index, row in df.iterrows():
    user_data = {
        "username": row["username"],
        "first_name": row["first_name"],
        "last_name": row["last_name"],
        "email": row["email"],
        "is_active": bool(row["is_active"]),  # Convert to boolean
        "is_superuser": bool(row["is_superuser"]),  # Convert to boolean
        "password": row["password"]
    }
    
    response = requests.post(API_URL, json=user_data, headers=headers)
    
    if response.status_code == 201:
        print(f"User {user_data['username']} created successfully.")
    else:
        print(f"Failed to create user {user_data['username']}. Status code: {response.status_code}, Response: {response.text}")